{% load i18n %} {%load static%}
<!DOCTYPE html> {% include 'nav.html' %}

<body>
    <div id="wrapper">
        <div class="overlay"></div>

        <!-- Sidebar -->
        <nav class="navbar navbar-inverse navbar-fixed-top" id="sidebar-wrapper" role="navigation">
            <ul class="nav sidebar-nav">
                <li class="sidebar-brand">
                    <a href="#">
                        {%trans "果瑞士"%}
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa fa-fw fa-file-o"></i> {% blocktrans %}税率{% endblocktrans %}</a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa fa-fw fa-file-o"></i> {%trans "货品"%}</a>
                </li>
                <li>
                    <a href="#">
                        <i class="fa fa-fw fa-file-o"></i> {%trans "权重"%}</a>
                </li>
            </ul>
        </nav>
        <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <button type="button" class="hamburger is-closed animated fadeInLeft" data-toggle="offcanvas">
                <span class="hamb-top"></span>
                <span class="hamb-middle"></span>
                <span class="hamb-bottom"></span>
            </button>
            <div class="container">
                <div class="col-md-12">

                    <div class="panel panel-success" id="basics_tax">
                        <div class="panel-heading">
                            <h3>{% trans "税率"%}</h3>
                        </div>

                        <table data-toggle="table" data-pagination=true>
                            <thead>
                                <tr>
                                    <th data-align='center' data-valign='middle'>{%trans "月份"%}</th>
                                    <th data-align='center' data-valign='middle'>{%trans "税率"%}</th>
                                </tr>

                            </thead>
                            <tbody>
                                {% for tax_rate in tax %}
                                <tr>
                                    <td>{{tax_rate.time}}</td>
                                    <td>{{tax_rate.tax}}</td>
                                </tr>
                                {% endfor %}

                            </tbody>
                        </table>
                    </div>


                    <div class="panel panel-success" id="basics_goods">
                        <div class="panel-heading">
                            <h3>{%trans "货品"%}</h3>
                        </div>

                        <table data-toggle="table" data-pagination=true>
                            <thead>
                                <tr>
                                    <th data-align='center' data-valign='middle'>{%trans "货品"%}</th>
                                    <th data-align='center' data-valign='middle'>{%trans "货品说明"%}</th>
                                    <th data-align='center' data-valign='middle'>{%trans "代码"%}</th>
                                </tr>

                            </thead>
                            <tbody>
                                {% for goods_list in goods %}

                                <tr>
                                    <td>{{goods_list.goods_id}}</td>
                                    <td>{{goods_list.goods_name}}</td>
                                    <td>{{goods_list.gpc}}</td>
                                </tr>
                                {% endfor %}

                            </tbody>
                        </table>
                    </div>



                    <div class="panel panel-success" id="basics_sku">
                        <div class="panel-heading">
                            <h3>{%trans "权重"%}</h3>
                        </div>
                        <table data-toggle="table" data-pagination=true>
                            <thead>
                                <tr>
                                    <th data-align='center' data-valign='middle'>{%trans "序号"%}</th>
                                    <th data-align='center' data-valign='middle'>{%trans "货品代码"%}</th>
                                    <th data-align='center' data-valign='middle'>{%trans "名称"%}</th>
                                    <th data-align='center' data-valign='middle'>{%trans "权重值"%}</th>
                                </tr>

                            </thead>
                            <tbody>
                                {% for sku_list in sku %}
                                <tr>
                                    <td>{{sku_list.seq_no}}</td>
                                    <td>{{sku_list.sku_id}}</td>
                                    <td>{{sku_list.sku_name}}</td>
                                    <td>{{sku_list.price}}</td>
                                </tr>
                                {% endfor %}

                            </tbody>
                        </table>
                    </div>

                    <div class="panel panel-success" id="basics_bom">
                        <div class="panel-heading">
                            <h3>bom {%trans "修改"%}</h3>
                        </div>
                        <table id="bom"></table>
                    </div>

                </div>

            </div>
        </div>
        <!-- /#page-content-wrapper -->

    </div>
    <!-- /#wrapper -->
</body>

<script>
    $(document).ready(function () {
        var trigger = $('.hamburger'),
            overlay = $('.overlay'),
            isClosed = false;

        trigger.click(function () {
            hamburger_cross();
        });

        function hamburger_cross() {

            if (isClosed == true) {
                overlay.hide();
                trigger.removeClass('is-open');
                trigger.addClass('is-closed');
                isClosed = false;
            } else {
                overlay.show();
                trigger.removeClass('is-closed');
                trigger.addClass('is-open');
                isClosed = true;
            }
        }

        $('[data-toggle="offcanvas"]').click(function () {
            $('#wrapper').toggleClass('toggled');
        });
        get_bom();
    });
</script>
<script>
    var get_bom = function getbom() {
        $('#bom').bootstrapTable({
            toolbar: "#toolbar",
            showRefresh: true,
            pagination: true,
            clickToSelect: true,
            queryParams: function (param) {
                return {};
            },
            url: "/get_bom",
            columns: [{
                    field: 'Num',
                    title: "序号"
                },
                {
                    field: 'product_name',
                    title: "名称",
                },
                {
                    field: 'price',
                    title: "单价",
                },
                {
                    field: 'goods',
                    title: "物料清单",
                    editable: {
                        type: 'checklist',
                        title: '物料清单',
                        separator: ",",
                        source: [{
                                value: '708390000203',
                                text: '708390000203'
                            }, {
                                value: '708390000210',
                                text: '708390000210'
                            },
                            {
                                value: '708390000227',
                                text: '708390000227'
                            }, {
                                value: '7290108800098',
                                text: '7290108800098'
                            }, {
                                value: 'XY521067771349',
                                text: 'XY521067771349'
                            }, {
                                value: 'XY521068155265',
                                text: 'XY521068155265'
                            }, {
                                value: 'XY521073901132',
                                text: 'XY521073901132'
                            }, {
                                value: 'XY521074093868',
                                text: 'XY521074093868'
                            }, {
                                value: 'XY521074249153',
                                text: 'XY521074249153'
                            }, {
                                value: 'XY521074725008',
                                text: 'XY521074725008'
                            }, {
                                value: 'XY521077050523',
                                text: 'XY521077050523'
                            }, {
                                value: 'XY521077162825',
                                text: 'XY521077162825'
                            }, {
                                value: 'XY521077912497',
                                text: 'XY521077912497'
                            }, {
                                value: 'XY521078064529',
                                text: 'XY521078064529'
                            }, {
                                value: 'XY521078232623',
                                text: 'XY521078232623'
                            }, {
                                value: 'XY521078390258',
                                text: 'XY521078390258'
                            }, {
                                value: '8802534778019',
                                text: '8802534778019'
                            }, {
                                value: '8802534778002',
                                text: '8802534778002'
                            }, {
                                value: '9999',
                                text: '9999'
                            }, {
                                value: 'X708390000326',
                                text: 'X708390000326'
                            }
                        ],

                    }
                }
            ],
            onEditableSave: function (field, row, oldValue, $el) {
                console.log(row);
                $.ajax({
                    type: "post",
                    url: "/update_bom_edit/",
                    data: row,
                    dataType: 'JSON',
                    Charset:"utf8",
                    success: function (data) {
                        console.log(data)
                        if (data ==
                            "success") {
                            alert('提交数据成功');
                        }
                    },
                    error: function () {
                        alert('编辑失败');
                    },
                    complete: function () {}
                });
            }

        })
    }
</script>

</html>