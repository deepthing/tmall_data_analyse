TRUNCATE TABLE t_settle_amount_info;

insert into t_settle_amount_info( period , alipay_settle , alipay_settle_p , alipay_settle_r , alipay_settle_usd , alipay_settle_p_usd , alipay_settle_r_usd , alipay_fee_usd , account_fee) select period , sum(alipay_settle) , sum(alipay_settle_p) , sum(alipay_settle_r) , sum(alipay_settle_usd) , sum(alipay_settle_p_usd) , sum(alipay_settle_r_usd) , sum(alipay_fee_usd) , sum(account_fee) from( select SUBSTR(Settlement_time FROM 1 FOR 10) as period , sum(Rmb_settlement) alipay_settle , 0 as alipay_settle_p , 0 as alipay_settle_r , sum(Settlement) as alipay_settle_usd , 0 as alipay_settle_p_usd , 0 as alipay_settle_r_usd , sum(Fee) as alipay_fee_usd , 0 as account_fee from load_settledetails_info group BY SUBSTR(Settlement_time FROM 1 FOR 10) UNION select SUBSTR(Settlement_time FROM 1 FOR 10) , 0 , sum(Rmb_amount) , 0 , 0 , sum(Amount) , 0 , 0 , 0 from load_settledetails_info where Type = 'P' group BY SUBSTR(Settlement_time FROM 1 FOR 10) UNION select SUBSTR(Settlement_time FROM 1 FOR 10) , 0 , 0 , sum(Rmb_amount) , 0 , 0 , sum(Amount) , 0 , 0 from load_settledetails_info where Type = 'R' group BY SUBSTR(Settlement_time FROM 1 FOR 10) UNION select SUBSTR(Settlement_time FROM 1 FOR 10) , 0 , 0 , 0 , 0 , 0 , 0 , 0 , sum(Fee * Rate) from load_settledetails_info group BY SUBSTR(Settlement_time FROM 1 FOR 10)) t GROUP BY period;

